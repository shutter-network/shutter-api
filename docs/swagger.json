{
    "swagger": "2.0",
    "info": {
        "description": "Shutter API is an encryption and decryption API that allows clients to register decryption triggers for specific encrypted messages. These triggers are invoked at a future time, eventually releasing the keys needed to decrypt the messages. Clients can specify the exact timestamp at which the trigger should release the decryption keys.",
        "title": "Shutter API",
        "contact": {}
    },
    "paths": {
        "/compile_event_trigger_definition": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "This endpoint takes an event signature snippet and some arguments to create an event trigger definition that will be understood by keypers",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Allows clients to compile an event trigger definition string.",
                "parameters": [
                    {
                        "description": "Event signature and match arguments.",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/EventTriggerDefinitionRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "$ref": "#/definitions/usecase.EventTriggerDefinitionResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid Event Data.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        },
        "/decrypt_commitment": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Provides a way for clients to easily decrypt their encrypted message for which they have registered the identity for. The trigger condition for the decryption key (timestamp or event) to be released must have been met for the message to be decrypted successfully.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Allows clients to decrypt their encrypted message.",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Identity used for registration and encrypting the message.",
                        "name": "identity",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Encrypted commitment is the clients encrypted message.",
                        "name": "encryptedCommitment",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "integer",
                                "format": "int32"
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid Decrypt commitment request.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        },
        "/get_data_for_encryption": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Retrieves all the necessary data required by clients for encrypting any message. Supports both time-based and event-based identity computation. If triggerDefinition is provided, the identity will be computed for event-based triggers. Otherwise, it uses time-based identity computation.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Provides data necessary to allow encryption.",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Ethereum address associated with the identity. Time‑based: use the address that will register the identity (your account if self‑registering, or the API signer address below if you are using the API register endpoint). Event‑based (triggerDefinition provided): users cannot self‑register because the registry is owner‑only, please use the API signer address below. Gnosis Mainnet API address: 0x228DefCF37Da29475F0EE2B9E4dfAeDc3b0746bc Chiado API address: 0xb9C303443c9af84777e60D5C987AbF0c43844918",
                        "name": "address",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Optional identity prefix. You can generate it on your end and pass it to this endpoint, or allow the API to randomly generate one for you.",
                        "name": "identityPrefix",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Optional event trigger definition (hex-encoded with 0x prefix). If provided, identity will be computed for event-based triggers. This parameter is strictly for event-based triggers.",
                        "name": "triggerDefinition",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "$ref": "#/definitions/GetDataForEncryption"
                        }
                    },
                    "400": {
                        "description": "Invalid Get data for encryption request.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        },
        "/get_decryption_key": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Retrieves a decryption key for a given registered identity once the timestamp is reached. Decryption key is 0x padded, clients need to remove the prefix when decrypting on their end.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Get decryption key.",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Identity associated with the decryption key.",
                        "name": "identity",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "$ref": "#/definitions/GetDecryptionKey"
                        }
                    },
                    "400": {
                        "description": "Invalid Get decryption key request.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "404": {
                        "description": "Decryption key not found for the associated identity.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        },
        "/get_event_trigger_expiration_block": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Retrieves the expiration block number for a given event identity registration.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Get event identity registration expiration block number.",
                "parameters": [
                    {
                        "type": "integer",
                        "format": "int64",
                        "description": "Eon number associated with the event identity registration.",
                        "name": "eon",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Identity prefix associated with the event identity registration.",
                        "name": "identityPrefix",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "$ref": "#/definitions/GetEventTriggerExpirationBlock"
                        }
                    },
                    "400": {
                        "description": "Invalid Get event identity registration expiration block number request.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "404": {
                        "description": "Event identity registration not found.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        },
        "/register_event_identity": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Allows clients to register an identity used for encryption and event trigger definition for the decryption key associated with the encrypted message.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Allows clients to register an event trigger identity.",
                "parameters": [
                    {
                        "description": "Event trigger definition, ttl and Identity which client want to make the registration with.",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/RegisterEventIdentityRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "$ref": "#/definitions/RegisterIdentityResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid Register identity request.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        },
        "/register_identity": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Allows clients to register an identity used for encryption and specify a release timestamp for the decryption key associated with the encrypted message.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Crypto"
                ],
                "summary": "Allows clients to register any identity.",
                "parameters": [
                    {
                        "description": "Timestamp and Identity which client want to make the registration with.",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/RegisterIdentityRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success.",
                        "schema": {
                            "$ref": "#/definitions/RegisterIdentityResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid Register identity request.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "429": {
                        "description": "Too many requests. Rate limited.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    },
                    "500": {
                        "description": "Internal server error.",
                        "schema": {
                            "$ref": "#/definitions/error.Http"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "EventTriggerDefinitionRequest": {
            "type": "object",
            "properties": {
                "arguments": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/usecase.EventArgument"
                    }
                },
                "contract": {
                    "type": "string",
                    "example": "0x3465a347342B72BCf800aBf814324ba4a803c32b"
                },
                "eventSig": {
                    "type": "string",
                    "example": "Transfer(address indexed from, address indexed to, uint256 amount)"
                }
            }
        },
        "GetDataForEncryption": {
            "type": "object",
            "properties": {
                "eon": {
                    "type": "integer",
                    "example": 1
                },
                "eon_key": {
                    "type": "string",
                    "example": "0x57af5437a84ef50e5ed75772c18ae38b168bb07c50cadb65fc6136604e662255"
                },
                "epoch_id": {
                    "type": "string",
                    "example": "0x88f2495d1240f9c5523db589996a50a4984ee7a08a8a8f4b269e4345b383310abd2dc1cd9c9c2b8718ed3f486d5242f5"
                },
                "identity": {
                    "type": "string",
                    "example": "0x8c232eae4f957259e9d6b68301d529e9851b8642874c8f59d2bd0fb84a570c75"
                },
                "identity_prefix": {
                    "type": "string",
                    "example": "0x79bc8f6b4fcb02c651d6a702b7ad965c7fca19e94a9646d21ae90c8b54c030a0"
                }
            }
        },
        "GetDecryptionKey": {
            "type": "object",
            "properties": {
                "decryption_key": {
                    "type": "string",
                    "example": "0x99a805fc26812c13041126b25e91eccf3de464d1df7a95d1edca8831a9ec02dd"
                },
                "decryption_timestamp": {
                    "type": "integer",
                    "example": 1735044061
                },
                "identity": {
                    "type": "string",
                    "example": "0x8c232eae4f957259e9d6b68301d529e9851b8642874c8f59d2bd0fb84a570c75"
                }
            }
        },
        "GetEventTriggerExpirationBlock": {
            "type": "object",
            "properties": {
                "expiration_block_number": {
                    "type": "integer",
                    "example": 12345678
                }
            }
        },
        "RegisterEventIdentityRequest": {
            "type": "object",
            "properties": {
                "identityPrefix": {
                    "type": "string",
                    "example": "0x79bc8f6b4fcb02c651d6a702b7ad965c7fca19e94a9646d21ae90c8b54c030a0"
                },
                "triggerDefinition": {
                    "type": "string",
                    "example": "0x79bc8f6b4fcb02c651d6a702b7ad965c7fca19e94a9646d21ae90c8b54c030a0"
                },
                "ttl": {
                    "type": "integer",
                    "example": 100
                }
            }
        },
        "RegisterIdentityRequest": {
            "type": "object",
            "properties": {
                "decryptionTimestamp": {
                    "type": "integer",
                    "example": 1735044061
                },
                "identityPrefix": {
                    "type": "string",
                    "example": "0x79bc8f6b4fcb02c651d6a702b7ad965c7fca19e94a9646d21ae90c8b54c030a0"
                }
            }
        },
        "RegisterIdentityResponse": {
            "type": "object",
            "properties": {
                "eon": {
                    "type": "integer",
                    "example": 1
                },
                "eon_key": {
                    "type": "string",
                    "example": "0x57af5437a84ef50e5ed75772c18ae38b168bb07c50cadb65fc6136604e662255"
                },
                "identity": {
                    "type": "string",
                    "example": "0x8c232eae4f957259e9d6b68301d529e9851b8642874c8f59d2bd0fb84a570c75"
                },
                "identity_prefix": {
                    "type": "string",
                    "example": "0x79bc8f6b4fcb02c651d6a702b7ad965c7fca19e94a9646d21ae90c8b54c030a0"
                },
                "tx_hash": {
                    "type": "string",
                    "example": "0x3026ad202ca611551377eef069fb6ed894eae65329ce73c56f300129694f12ba"
                }
            }
        },
        "error.Http": {
            "type": "object",
            "properties": {
                "description": {
                    "type": "string"
                },
                "metadata": {
                    "type": "string"
                },
                "statusCode": {
                    "type": "integer"
                }
            }
        },
        "usecase.EventArgument": {
            "type": "object",
            "properties": {
                "bytes": {
                    "type": "string",
                    "example": "0xabcdef01234567"
                },
                "name": {
                    "type": "string",
                    "example": "amount"
                },
                "number": {
                    "type": "string",
                    "example": "25433"
                },
                "op": {
                    "type": "string",
                    "example": "gte"
                }
            }
        },
        "usecase.EventTriggerDefinitionResponse": {
            "type": "object",
            "properties": {
                "trigger_definition": {
                    "type": "string",
                    "example": "0x79bc8f6b4fcb02c651d6a702b7ad965c7fca19e94a9646d21ae90c8b54c030a0"
                }
            }
        }
    },
    "securityDefinitions": {
        "BearerAuth": {
            "description": "(Optional): Type \"Bearer\" followed by a space and your API key.",
            "type": "apiKey",
            "name": "Authorization",
            "in": "header"
        }
    }
}